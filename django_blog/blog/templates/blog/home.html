{% extends "blog/base.html" %}

{% block title %}Home - Latest Posts{% endblock %}

{% block content %}
    {# --- ADD THE CREATE POST BUTTON HERE --- #}
    {% if user.is_authenticated %}
        <a class="btn btn-info mb-4" href="{% url 'post-create' %}">
            Create New Post
        </a>
    {% endif %}
    {# --------------------------------------- #}
    
    <h1>Latest Blog Posts</h1>

    {% for post in posts %}
        <div class="post-entry">
            <h2><a href="{% url 'post-detail' pk=post.pk %}">{{ post.title }}</a></h2>
            <p>
                By **{{ post.author.username }}** on {{ post.published_date|date:"F d, Y" }} 
            </p>
            <p>{{ post.content|truncatewords:30 }}</p> 
            
            {# FIX: Updated Read More link to point to the actual post detail page #}
            <a href="{% url 'post-detail' pk=post.pk %}">Read More &raquo;</a> 
            
            <hr>
        </div>
    {% empty %}
        <p>No posts have been published yet.</p>
    {% endfor %}
{% endblock content %}